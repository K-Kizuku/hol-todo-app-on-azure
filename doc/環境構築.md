[READMEに戻る](../README.md)
# 環境構築(Djangoのロケット飛ばす所まで)
## Githubからコードをcloneする
デスクトップに移動する。

ターミナルを開き以下のコマンドを入力。 【クローンするディレクトリに注意】

```
cd Desktop
git clone https://github.com/alterbooth/hol-todo-app-on-azure.git
```

## VSCodeを開く
クローンしたフォルダに移動し、VSCodeで開く。

```
cd hol-todo-app-on-azure
code .
```

## settings.pyを書き換える
./todoProject/settings.pyを以下に書き換える

```python:./todoProject/settings.py
ALLOWED_HOSTS = ['*']
 :
LANGUAGE_CODE = 'ja'
TIME_ZONE = 'Asia/Tokyo'
```

## Dockerfileを編集

```
# python:3.8の公式 image をベースの image として設定
FROM python:3.8

# コンテナの8000番ポートを公開
EXPOSE 8000

# 作業ディレクトリの作成
RUN mkdir /code

# 作業ディレクトリの設定
WORKDIR /code

# カレントディレクトリにある資産をコンテナ上の指定のディレクトリにコピーする
ADD . /code

# pipでrequirements.txtに指定されているパッケージを追加する
RUN pip install -r requirements.txt

# マイグレート
RUN python manage.py migrate

# シェルファイルへのアクセス権限
RUN chmod 744 ./startup.sh

# 起動コマンドが書かれたシェルファイルを実行
ENTRYPOINT ["./startup.sh"]
```

## .shファイルを編集
.shファイルに以下を記述する。

```
#!/bin/bash
python manage.py runserver 0.0.0.0:8000
```

## requirements.txtを編集
requirements.txtに以下を記述する。

```
Django==3.1
django-environ==0.8.1
```

## Dockerfileからイメージの作成
Dockerfile を用意した後に docker build -t [作成する image 名] [Dockerfileまでの相対パス] コマンドを実行することで image が作成されます。
今回は hello-world という名前の image を作成します。

```
docker build -t hello-world .
```


## コンテナの起動
image を作成したので、コンテナを起動させます。

```
docker container run -d -p 8000:8000 hello-world
```

[http://localhost:8000](http://localhost:8000)にアクセスするとロケットが飛ぶ


### 参考サイト
[Django の開発環境の Dockerfile を作成してみた](https://qiita.com/sugurutakahashi12345/items/6d68e6bb9163961a8d4d)














# Azureにデプロイ
まず、ロケットの画面の状態をデプロイします。次に、表示をHello,World.に変更、それをもう一度デプロイします。

### 手順の流れ
* [ACR作成(Azureで作業)](#arc作成)
* [ACRのレジストリにDockerイメージをプッシュ(ローカルで作業)](#acrのクイックスタートローカルで作業)
* [AppServiceの作成とデプロイ](#webappを作成azureで作業)

## ACR作成(Azureで作業)
[https://portal.azure.com/](https://portal.azure.com/)にアクセス。

「 **コンテナレジストリ** 」と検索しコンテナレジストリのページを開く。「 **作成** 」を押し、以下の画像のように入力する。<br>
リソースグループは「 **todo-app** 」(他の文字でも可)、レジストリ名は **任意の文字** を入力する。


![acr-make](img/acr-make.png)
### ACRの設定
ローカルPCから **ACRにログインするために必要な設定** を行います。

**設定** → **アクセスキー** → **管理者ユーザを有効**

![acr-setting](img/acr-setting.png)

## ACRのクイックスタート(ローカルで作業)
作成したコンテナレジストリの **クイックスタート** のページを開きます。<br>クイックスタートのコマンドは自分のコンテナレジストリの名前になっているので、 **コピー&ペーストで簡単に実行できます** 。<br>(**3.ログイン**と**4.プッシュ**のコマンドを使用します)

![acr-login](img/acr-login.png)

### 1.ACRにログイン
以下のコマンドを実行して **ACRにログイン** をします。上手くいくと **username** と **password** が求められます。<br>
**username** と **password** は、[ARCのアクセスキーのもの](#acrの設定)を使用して下さい (ARC作成時に有効に設定したもの)

```
docker login レジストリ名.azurecr.io
```
### 2.レジストリにプッシュ
まず、イメージの前にレジストリ ログイン URI を付加し、プライベート レジストリにプッシュできるようにしましょう。

レジストリにアップロードするためにイメージにタグを付け、イメージをプッシュします。

```
docker tag hello-world レジストリ名.azurecr.io/hello-world
docker push レジストリ名.azurecr.io/hello-world
```

## Webappを作成(Azureで作業)

![webapp-make](img/webapp-make.png)

![webapp-docker](img/webapp-docker.png)

確認および作成のポタンを推し作成する。
## デプロイ完了
デプロイが完了すると、webappに移動します。

![webapp-url](img/webapp-url.png)

![django-rocket](img/django-rocket.png)



## 参考サイト
* [Azure App Service を使ってコンテナー化された Web アプリをデプロイして実行する](https://docs.microsoft.com/ja-jp/learn/modules/deploy-run-container-app-service/)
* [コンテナのGithub Actions](https://docs.microsoft.com/ja-jp/azure/app-service/deploy-container-github-action?tabs=service-principal)
* [AzureにDjangoで作ったwebアプリのContainerをデプロイしてみる](https://zenn.dev/ibaraki/scraps/a7b7fd0592e228)


# Azureにデプロイ
まず、ロケットの画面の状態をデプロイします。次に、表示をHello,World.に変更、それをもう一度デプロイします。

### 手順の流れ
* [ACR作成(Azureで作業)](#arc作成)
* [ACRのレジストリにDockerイメージをプッシュ(ローカルで作業)](#acrのクイックスタートローカルで作業)
* [AppServiceの作成とデプロイ](#webappを作成azureで作業)

## ACR作成(Azureで作業)
[https://portal.azure.com/](https://portal.azure.com/)にアクセス。

「コンテナレジストリ」と検索しコンテナレジストリのページを開く。「作成」を押し、以下の画像のように入力する。<br>
リソースグループは「todo-app」、レジストリ名は任意の文字を入力する。


![acr-make](img/acr-make.png)
### ACRの設定
ローカルPCからACRにログインするために必要な設定を行います。

設定→アクセスキー→管理者ユーザを有効

![acr-setting](img/acr-setting.png)

## ACRのクイックスタート(ローカルで作業)
作成したコンテナレジストリのクイックスタートのコマンドを使用すると簡単にできます。<br>(**3.ログイン**と**4.プッシュ**のコマンドを使用します)

![acr-login](img/acr-login.png)

### 1.ACRにログイン
usernameとpwは、ARCのアクセスキー使用 (ARC作成で設定したもの)

```
docker login レジストリ名.azurecr.io
```
### 2.レジストリにプッシュ
まず、イメージの前にレジストリ ログイン URI を付加し、プライベート レジストリにプッシュできるようにしましょう。

レジストリにアップロードするためにイメージにタグを付け、イメージをプッシュします。

```
docker tag hello-world レジストリ名.azurecr.io/hello-world
docker push レジストリ名.azurecr.io/hello-world
```

## Webappを作成(Azureで作業)

![webapp-make](img/webapp-make.png)

![webapp-docker](img/webapp-docker.png)

確認および作成のポタンを推し作成する。
## デプロイ完了
デプロイが完了すると、webappに移動します。

![webapp-url](img/webapp-url.png)

![django-rocket](img/django-rocket.png)



## 参考サイト
* [Azure App Service を使ってコンテナー化された Web アプリをデプロイして実行する](https://docs.microsoft.com/ja-jp/learn/modules/deploy-run-container-app-service/)
* [コンテナのGithub Actions](https://docs.microsoft.com/ja-jp/azure/app-service/deploy-container-github-action?tabs=service-principal)
* [AzureにDjangoで作ったwebアプリのContainerをデプロイしてみる](https://zenn.dev/ibaraki/scraps/a7b7fd0592e228)

